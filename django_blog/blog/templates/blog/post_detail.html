{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ object.title }}</title>
  <link rel="stylesheet" href="{% static 'blog/css/styles.css' %}">
</head>
<body>
  <p><a href="{% url 'post-list' %}">‚Üê Back to all posts</a></p>
  <h1>{{ object.title }}</h1>
  <p>By {{ object.author.username }} on {{ object.published_date }}</p>
  <article>
    {{ object.content|linebreaks }}
  </article>
  {% if object.tags.exists %}
    <div>
      Tags:
      {% for tag in object.tags.all %}
        <a href="{% url 'posts-by-tag' tag.name %}">{{ tag.name }}</a>{% if not forloop.last %}, {% endif %}
      {% endfor %}
    </div>
  {% endif %}

  {% if user == object.author %}
    <p>
      <a href="{% url 'post-update' object.pk %}">Edit</a>
      |
      <a href="{% url 'post-delete' object.pk %}">Delete</a>
    </p>
  {% endif %}

  <hr>
  <h2>Comments</h2>
  {% if comments %}
    <ul>
      {% for comment in comments %}
        <li>
          <p><strong>{{ comment.author.username }}</strong> on {{ comment.created_at }}</p>
          <div>{{ comment.content|linebreaks }}</div>
          {% if user == comment.author %}
            <p>
              <a href="{% url 'comment-update' comment.pk %}">Edit</a> |
              <a href="{% url 'comment-delete' comment.pk %}">Delete</a>
            </p>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No comments yet.</p>
  {% endif %}

  {% if user.is_authenticated %}
  <h3>Add a comment</h3>
  <form action="{% url 'comment-create' object.pk %}" method="post">
    {% csrf_token %}
    {{ comment_form.as_p }}
    <button type="submit">Post comment</button>
  </form>
  {% else %}
  <p><a href="{% url 'login' %}">Log in</a> to comment.</p>
  {% endif %}
</body>
</html>


